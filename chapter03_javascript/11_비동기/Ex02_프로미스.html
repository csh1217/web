<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    
</body>
<script>
    /*
        프로미스(promise)
        - 자바스크립트의 비동기 작업을 처리하고, 결과를 다루는 객체
        - 이전 콜백 함수로 모든 비동기를 처리해야 되는 상황을 조금 편리하게 사용하기 위해 ES6로부터 도입된 기능

        프로미스는 세 가지의 상태로 나뉜다
        1. 대기(pending) : 비동기 작업이 완료되지 않은 상태
        2. 이행(fulfilled) : 비동기 작업이 성공적으로 완료된 상태
        3. 거부(rejected) : 비동기 작업이 실패한 상태

        프로미스의 형식
        const prom = new Promise((resolve, reject)=>{
            // 코드
        });
        - new 키워드를 이용하여 Promise 객체 생성
        - resolve는 작업이 성공하면 호출되는 함수
        - reject는 작업이 실패했을 때 호출되는 함수
    */

    // 프로미스 객체가 호출할 때, 성공하면 then() 함수를, 실패하면 catch()를 붙여서 사용한다.
    const prom = new Promise((resolve, reject)=>{
        //resolve('성공');
        reject('실패');
    });

    prom.then( result => {
        console.log(result);
    }).catch(err=>{
        console.log(err);
        
    });

    const prom2 = new Promise((resolve, reject)=>{
        let ran = Math.floor(Math.random()*10) + 1;
        console.log(ran);
        ran > 5 ? resolve('성공'):reject(new Error('실패'));
    });

    prom2.
        then(result=>{
            console.log(`resolve 호출 -> ${result}`);
        })
        .catch(err=>{
            console.log(err);
        });


    function print(n){
        return new Promise((resolve, reject)=>{
            setTimeout(()=>{
                let val = n+1;
                console.log(val);
                if(val<5){
                    resolve(val);
                }
            }, 1000);
        });
    }
    print(2)
        .then(n => {return print(n);})
        .then(n => {return print(n);})
        .then(n => {return print(n);})
        .then(n => {return print(n);});

</script>
</html>